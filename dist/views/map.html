<div map-lazy-load="http://maps.google.com/maps/api/js">
  <ng-map center="USA" zoom="4" map-type-id="satellite" style="height:800px">
    <marker
      ng-repeat="(id, obser) in gmap.observations"
      position="{{obser.latitude}},{{obser.longitude}}"
      on-click="selectObservation(event, obser)"
	  id="{{id}}"
      />
    <info-window id="iw" visible-on-marker="{{obs.id}}">
		<div ng-cloak ng-show="obs" ng-non-bindable="">
		<h3><img ng-src='{{obs.context.extras.Icon}}' style="width:32px; height:32px"/>{{obs.context.title}}</h3>
		<a href="#/observation/{{obs.id}}"><img ng-repeat="m in obs.medias" ng-src="{{m.link | medium}}" style="width:250px; height:250px" /></a>
		<blockquote>{{obs.content}}</blockquote>
		<p>by {{obs.account.username}} on {{obs.created_at | date: mediumDate }}</p>
		
		<div class="detailBox">
			<div class="titleBox"> 
			<label><h5>Comments</h5> </label> 
			</div> 
			<div class="actionBox"> 
			<ul class="commentList">
				<div ng-if="obs.feedbacks.length <= 1">No comments.</div>
				<li ng-repeat="feedback in obs.feedbacks" ng-if="!$first"> 
				<div class="commentText">
					<em>{{ feedback.content }}</em>
					<span class="date sub-text">
					<h5> commented by: {{ feedback.account.username }} on {{ feedback.created_at | date}}</h5>
					</span>                      
				</div> 
				</li> 
			</ul> 
			<!--<form class="form-inline" role="form"> 
				<div class="form-group"> 
				<input class="form-control" type="text" placeholder="Your comments" ng-model="comment" ng-value="comment"> </div> 
				<div class="form-group"> 
				<button class="btn btn-default btn-add-comment" ng-click="addComment()">Submit</button> 
				</div>
			</form>
			--> 
			<div class="alert alert-warning alert-dismissible" ng-show="showAlert" role="alert"> 
				<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button> <strong>Warning!</strong> You need to sign in to leave a comment. 
			</div> 
			</div> 
		</div> 
		</div>
	</info-window>
  </ng-map>
</div>
